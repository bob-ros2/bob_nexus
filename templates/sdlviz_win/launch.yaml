# Twitch Bot Template - Combined Brain & Vision
# Includes nested namespaces:
# - Viz: ${COMMON_NS}/${NAME}
# - LLM: ${COMMON_NS}/${NAME}/llm

- &entity_ns "__ns:=${COMMON_NS}/${NAME}"
- &llm_ns "__ns:=${COMMON_NS}/${NAME}/llm"

# 1. The Dashboard (Visual Head - with FFmpeg Streaming)
- name: viz
  package: bob_sdlviz
  executable: /bin/bash
  output: screen
  arguments:
    - -c
    # We call the start_stream script directly from the source directory.
    # We explicitly provide the ROS_SETUP_PATH for the container environment (/app/...).
    # The '#' shield prevents unwanted --ros-args from appending.
    - "export ROS_SETUP_PATH=/app/ros2_ws/install/setup.bash && /app/ros2_ws/src/bob_sdlviz/scripts/start_stream.sh #"

# 2. The Agent Logic (Cognitive Core)
- name: brain
  package: bob_llm
  executable: llm
  output: screen
  arguments:
    - --ros-args
    - -p
    - api_url:=${API_URL}
    - -p
    - api_key:=${API_KEY}
    - -p
    - api_model:=${API_MODEL}
    - -p
    - "system_prompt:=${SYSTEM_PROMPT}"
    - -p
    - "tool_interfaces:=['${BOB_LLM_DIR}/config/qdrant_tools.py', '/app/master/core/skill_tools.py']"
    - -r
    - *llm_ns
